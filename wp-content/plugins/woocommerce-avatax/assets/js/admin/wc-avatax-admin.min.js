"use strict";!function(){jQuery(function(d){var o,t,a,i,n,r,l=null!=(a=window.wc_avatax_admin)?a:{},c=null!=(a=window.woocommerce_admin)?a:{},s=null!=(a=window.woocommerce_admin_meta_boxes)?a:{},_=null!=(a=window.accounting)?a:{};return l.reload_order_notes=function(a){a={security:a,order_id:s.post_id,action:"wc_avatax_get_order_notes"};return d("#woocommerce-order-notes").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),jQuery.get(l.ajax_url,a,function(a){return a.data.notes_html&&(d("ul.order_notes").empty(),d("ul.order_notes").append(d(a.data.notes_html).find("li"))),d("#woocommerce-order-notes").unblock()})},d("input.wc-avatax-connection-field").each(function(a,t){var n="connected"===d(t).data("wc-avatax-connection-status")?"dashicons-yes":"dashicons-no";return d(t).after('<span class="wc-avatax-connection-indicator dashicons"></span>'),d(t).siblings(".wc-avatax-connection-indicator").addClass(n)}),d("input#wc_avatax_enable_tax_calculation, input#wc_avatax_enable_address_validation, input#wc_avatax_enable_cross_border_classification").on("change toggle-section",function(a){var t=d(this),n=t.parents("tr").nextAll("tr");return t.prop("checked")?n.show():n.hide()}).trigger("toggle-section"),d("#wc_avatax_record_calculations").change(function(a){var t=d(this).parents("tr").next("tr");return d(this).attr("checked")?d(t).show():d(t).hide()}).change(),d("select#wc_avatax_tax_locations").change(function(a){d(this).parents("tr").nextAll("tr");return"specific"===d(this).val()?d(this).parent().parent().next("tr").show():d(this).parent().parent().next("tr").hide()}).change(),d("select#wc_avatax_origin_address_country").change(function(a){var t,n=d(this).parents("p").next("p");return"US"===(t=d(this).val())||"CA"===t?d(n).show():d(n).hide()}).change(),d("select#wc_avatax_calculate_on_cart").on("change",function(a){var t=d("#wc_avatax_calculate_on_cart_international_customers").closest("tr");return"yes"===d(this).val()?t.show():t.hide()}).trigger("change"),d("button.wc-avatax-address-validate").on("click",function(a){var t,n,e,c,o,i,r,s;return a.preventDefault(),t=d(this),i=d(t).siblings(".indicator"),e=d(t).parents(".forminp-address"),o=d(e).attr("data-address-id"),a=d(e).find("#"+o+"_address_1").val(),n=d(e).find("#"+o+"_city").val(),s=d(e).find("#"+o+"_state").val(),r=d(e).find("#"+o+"_postcode").val(),c=d(e).find("#"+o+"_country").val(),d(e).find("input, select").prop("disabled",!0),d(t).prop("disabled",!0),i.removeClass(),i.addClass("indicator spinner is-active"),a={line1:a,city:n,region:s,postcode:r,country:c,nonce:l.address_nonce,action:"wc_avatax_validate_origin_address"},jQuery.post(l.ajax_url,a,function(a){if(0!==a)return i.removeClass("spinner is-active"),d(e).find("#message").hide(),200===a.code?(d.each(a.address,function(a,t){return d("#"+o+"_"+a).val(t)}),i.addClass("dashicons dashicons-yes")):d(e).prepend('<div id="message" class="error notice is-dismissible"><p>'+a.error+"</p></div>"),d(e).find("input, select").prop("disabled",!1),d(t).prop("disabled",!1)})}),d("#the-list").on("click",".editinline",function(a){var t=d(this).closest("tr").attr("id");return t=t.replace("post-",""),t=d("#wc_avatax_inline_"+t).find(".tax_code").text(),d('input[name="_wc_avatax_code"]').val(t)}),d("#woocommerce-order-items").on("change","input.refund_line_total",function(a){var t=d(this).closest("tr"),n=d(this).val(),e=d(t).find("input.wc_avatax_refund_line_rate").val();return d(t).find('input.refund_line_tax[data-tax_id="avatax"]').val(parseFloat(_.formatNumber(n*e,s.rounding_precision,"")).toString().replace(".",c.mon_decimal_point)).change()}),"yes"===d('#woocommerce-order-items input[name="wc_avatax_calculated"]').val()&&d("div.wc-order-refund-items .refund-actions").before('<div class="wc-avatax-refund-warning notice notice-warning">'+l.refund_ays+"</div>"),o=d("input#wc_avatax_enable_cross_border_classification"),r=function(){var a=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=o.closest("fieldset");return a?t.append('<p class="description">'+l.to_disable.stop_current_sync+"</p>"):t.closest("fieldset").find("p.description").remove()},o.prop("checked")&&"on"===l.sync_state&&(o.prop("disabled",!0),r(!0)),t=d.WCBackboneModal.View,i=function(a){return d("#wc-backbone-modal-dialog .modal-close").trigger("click"),a.button_class=a.button_class||"",new t({target:"wc-avatax-sync-modal",string:a})},n=function(a){var n=d(".wc-avatax-product-sync .syncing"),e=d(".wc-avatax-product-sync .connection-failed"),c=d("#wc-avatax-product-sync-button").prop("disabled",!0).addClass("disabled").append('<span class="indicator spinner is-active"></span>'),t={nonce:l.sync_nonce,action:"wc_avatax_toggle_cross_border_sync"};return jQuery.post(l.ajax_url,t,function(a){var t;if(a.success&&a.data)return a.data.toggled&&"yes"===a.data.toggled?("on"===l.sync_state?(l.sync_state="off",d(".forminp-product-sync").find(".description").text(""),n.hide(),o.prop("disabled",!1),r(!1)):(l.sync_state="on",n.show(),i({title:l.product_sync_modal.connect_title,body:l.product_sync_modal.connect_body}),o.prop("disabled",!0),r(!0)),t=c.attr("data-toggle-label"),c.attr("data-toggle-label",c.text()).text(t),e.hide()):e.show(),c.prop("disabled",!1).removeClass("disabled").find(".indicator").remove();console.log(a)})},d(document.body).on("wc_backbone_modal_response",function(a,t){if("wc-avatax-sync-modal"===t)return n()}),d("#wc-avatax-product-sync-button").on("click",function(a){return a.preventDefault(),"on"===l.sync_state?i({title:l.product_sync_modal.disconnect_title,body:l.product_sync_modal.disconnect_body,action:l.product_sync_modal.disconnect_action,cancel:l.product_sync_modal.disconnect_cancel}):n()}),d('.js-wc-plugin-framework-admin-notice.error[data-message-id="wc-avatax-sync-error-notice"]').on("click","a.button-primary",function(a){return a.preventDefault(),d(this).addClass("disabled").append('<span class="indicator spinner is-active"></span>'),d.get(this.href,function(a){return location.reload()})})})}.call(void 0);